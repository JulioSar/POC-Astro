import{r as c}from"./index.8b13ccb1.js";import{r as A}from"./index.cd0476e8.js";import{g as v,c as p}from"./index.cd2ea889.js";function U(e,n,{checkForDefaultPrevented:i=!0}={}){return function(o){if(e?.(o),i===!1||!o.defaultPrevented)return n?.(o)}}const b=c.createContext(void 0);function I(e){const n=c.useContext(b);return e||n||"ltr"}function h(e,n){return c.useReducer((i,r)=>{const o=n[i][r];return o??i},e)}const x=e=>{const{present:n,children:i}=e,r=M(n),o=typeof i=="function"?i({present:r.isPresent}):c.Children.only(i),s=v(r.ref,o.ref);return typeof i=="function"||r.isPresent?c.cloneElement(o,{ref:s}):null};x.displayName="Presence";function M(e){const[n,i]=c.useState(),r=c.useRef({}),o=c.useRef(e),s=c.useRef("none"),N=e?"mounted":"unmounted",[l,a]=h(N,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return c.useEffect(()=>{const t=m(r.current);s.current=l==="mounted"?t:"none"},[l]),p(()=>{const t=r.current,u=o.current;if(u!==e){const $=s.current,f=m(t);e?a("MOUNT"):f==="none"||t?.display==="none"?a("UNMOUNT"):a(u&&$!==f?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,a]),p(()=>{if(n){const t=d=>{const f=m(r.current).includes(d.animationName);d.target===n&&f&&A.flushSync(()=>a("ANIMATION_END"))},u=d=>{d.target===n&&(s.current=m(r.current))};return n.addEventListener("animationstart",u),n.addEventListener("animationcancel",t),n.addEventListener("animationend",t),()=>{n.removeEventListener("animationstart",u),n.removeEventListener("animationcancel",t),n.removeEventListener("animationend",t)}}else a("ANIMATION_END")},[n,a]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:c.useCallback(t=>{t&&(r.current=getComputedStyle(t)),i(t)},[])}}function m(e){return e?.animationName||"none"}export{x as $,U as a,I as b};
